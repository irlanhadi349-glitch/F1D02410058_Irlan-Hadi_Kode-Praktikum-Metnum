#include <iostream>
#include <cmath>

using namespace std;

double f(double t) {
    return (4 * t - pow(t, 3)) * exp(pow(t, 2));
}

double forwardDifference(double t, double h) {
    return (f(t + h) - f(t)) / h;
}

double backwardDifference(double t, double h) {
    return (f(t) - f(t - h)) / h;
}

double centeredDifference(double t, double h) {
    return (f(t + h) - f(t - h)) / (2 * h);
}

double newtonCotes13(double a, double b, double h) {
    double result = 0;
    int n = static_cast<int>((b - a) / h);
    
    if (n % 2 != 0) {
        n--;
    }
    
    result = f(a) + f(b);
    
    for (int i = 1; i < n; i++) {
        double x = a + i * h;
        if (i % 2 == 0) {
            result += 2 * f(x);
        } else {
            result += 4 * f(x);
        }
    }
    
    result *= h / 3;
    return result;
}

int main() {
    double x = 0.5;
    double h_values[] = {0.01, 0.001, 0.0001};

    cout << "1. Turunan Pertama di x = " << x << ":\n";
    for (int i = 0; i < 3; ++i) {
        double h = h_values[i];
        double forward_result = forwardDifference(x, h);
        double backward_result = backwardDifference(x, h);
        double centered_result = centeredDifference(x, h);
        
        cout << "h = " << h << "\n";
        cout << "Turunan Pertama (Selisih Maju): " << forward_result << "\n";
        cout << "Turunan Pertama (Selisih Mundur): " << backward_result << "\n";
        cout << "Turunan Pertama (Selisih Terpusat): " << centered_result << "\n";
        
        double error_forward = abs(forward_result - centered_result);
        double error_backward = abs(backward_result - centered_result);
        
        cout << "Error (Selisih Maju): " << error_forward << "\n";
        cout << "Error (Selisih Mundur): " << error_backward << "\n";
        cout << "\n";
    }

    double a = 0.0;
    double b = 1.0;

    cout << "2. Integral dengan Metode Newton-Cotes 1/3 (Simpson 1/3):\n";
    for (int i = 0; i < 3; ++i) {
        double h = h_values[i];
        double integral_result = newtonCotes13(a, b, h);
        cout << "h = " << h << "\n";
        cout << "Integral: " << integral_result << "\n";
        cout << "\n";
    }

    return 0;
}
